{
  "variables": {
    "do_api_token": "{{ env `PACKER_DO_TOKEN` }}"
  },
  "builders": [
    {
      "type": "docker",
      "image": "ubuntu",
      "commit": true
    }
  ],
  "provisioners": [
    {
      "type": "shell",
      "inline": ["apt-get update", "apt-get install -y curl golang"]
    },
    {
      "type": "shell",
      "inline": ["mkdir -p /var/opt/seeder-app"]
    },
    {
      "type": "file",
      "sources": ["go.mod", "go.sum", "main.go"],
      "destination": "/var/opt/seeder-app/"
    },
    {
      "type": "file",
      "source": "torrent_files",
      "destination": "/etc/torrent_files"
    },
    {
      "type": "shell",
      "inline": ["cd /var/opt/seeder-app", "go get", "go build main.go"]
    }
  ]
}
